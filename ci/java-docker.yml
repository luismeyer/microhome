cache:
  paths:
    - .m2/repository

variables:
  MAVEN_OPTS: "-Dmaven.repo.local=$CI_PROJECT_DIR/.m2/repository"

# Generalized job for packaging java programm
.install_java_docker_job:
  image: maven:latest
  stage: install
  when: manual
  script:
    - mvn clean install

# Generalized job for deployment to S3
.deploy_java_docker_job:
  image: python:latest
  stage: deploy
  before_script:
    - pip install awscli
    - apt-get update
    - apt-get install zip
  script:
    - rm -rf .idea src .m2
    - zip -r service .
    - aws s3 mv service.zip s3://wpm-build-bucket/
